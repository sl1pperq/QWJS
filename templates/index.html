<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>QuokkaWeather</title>
    <div id="links">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet"
              integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ"
              crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
                integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe"
                crossorigin="anonymous"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
    </div>
    <style>
        .bi-alarm {
            color: forestgreen;
        }

        .bi-thermometer-half {
            color: royalblue;
        }

        .bi-droplet {
            color: cadetblue;
        }

        .bi-brightness-high {
            color: orange;
        }

        .bi-search {
            color: lightslategray;
        }

        .bi-cloud {
            color: lightcoral;
        }

        .bi-droplet-half {
            color: steelblue;
        }

        .bi-truck {
            color: deeppink;
        }

        .bi-person {
            color: darkslategrey;
        }

        .bi-hourglass {
            color: darkorange;
        }

        .bi-stars {
            color: yellowgreen;
        }

        .bi-sunset {
            color: coral;
        }

        .bi-flag {
            color: pink;
        }

        .bi-arrow-up-left {
            color: dodgerblue;
        }

        .bi-chevron-double-left {
            color: darkseagreen;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="row">
        <div class="col-12">

            <div id="spinner" style="display: block" class="text-center mt-5">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
                <h5>Идёт загрузка данных...</h5>
            </div>

            <div id="card" style="display: none" class="card mt-4">
                <div class="card-body">
                    <h1 id="temp" class="card-title">Погода сейчас °C</h1>
                    <p id="info" class="card-text">Сейчас в городе</p>
                    <div class="row g-3">
                        <div class="col-md-4">
                            <h5>Основная информация</h5>
                            <ul class="list-group">
                                <li class="list-group-item">
                                    <ul class="list-inline">
                                        <li class="list-inline-item"><i class="bi bi-alarm"></i></li>
                                        <li id="time" class="list-inline-item">Время</li>
                                    </ul>
                                </li>
                                <li class="list-group-item">
                                    <ul class="list-inline">
                                        <li class="list-inline-item"><i class="bi bi-thermometer-half"></i></li>
                                        <li id="feels" class="list-inline-item">Ощущается как</li>
                                    </ul>
                                </li>
                                <li class="list-group-item">
                                    <ul class="list-inline">
                                        <li class="list-inline-item"><i class="bi bi-droplet"></i></li>
                                        <li id="humi" class="list-inline-item">Влажность</li>
                                    </ul>
                                </li>
                                <li class="list-group-item">
                                    <ul class="list-inline">
                                        <li class="list-inline-item"><i class="bi bi-brightness-high"></i></li>
                                        <li id="uv" class="list-inline-item">У/Ф излучение</li>
                                    </ul>
                                </li>
                                <li class="list-group-item">
                                    <ul class="list-inline">
                                        <li class="list-inline-item"><i class="bi bi-search"></i></li>
                                        <li id="visi" class="list-inline-item">Видимость</li>
                                    </ul>
                                </li>
                            </ul>
                        </div>

                        <div class="col-md-4">
                            <h5>Качество воздуха</h5>
                            <ul class="list-group">
                                <li class="list-group-item">
                                    <ul class="list-inline">
                                        <li class="list-inline-item"><i class="bi bi-cloud"></i></li>
                                        <li id="co" class="list-inline-item">CO</li>
                                    </ul>
                                </li>
                                <li class="list-group-item">
                                    <ul class="list-inline">
                                        <li class="list-inline-item"><i class="bi bi-droplet-half"></i></li>
                                        <li id="no2" class="list-inline-item">NO₂</li>
                                    </ul>
                                </li>
                                <li class="list-group-item">
                                    <ul class="list-inline">
                                        <li class="list-inline-item"><i class="bi bi-truck"></i></li>
                                        <li id="o3" class="list-inline-item">O₃</li>
                                    </ul>
                                </li>
                                <li class="list-group-item">
                                    <ul class="list-inline">
                                        <li class="list-inline-item"><i class="bi bi-person"></i></li>
                                        <li id="pm25" class="list-inline-item">PM 2.5</li>
                                    </ul>
                                </li>
                                <li class="list-group-item">
                                    <ul class="list-inline">
                                        <li class="list-inline-item"><i class="bi bi-hourglass"></i></li>
                                        <li id="pm10" class="list-inline-item">PM 10</li>
                                    </ul>
                                </li>
                            </ul>
                        </div>

                        <div class="col-md-4">
                            <h5>Другая информация</h5>
                            <ul class="list-group">
                                <li class="list-group-item">
                                    <ul class="list-inline">
                                        <li class="list-inline-item"><i class="bi bi-stars"></i></li>
                                        <li id="sunrise" class="list-inline-item">Восход</li>
                                    </ul>
                                </li>
                                <li class="list-group-item">
                                    <ul class="list-inline">
                                        <li class="list-inline-item"><i class="bi bi-sunset"></i></li>
                                        <li id="sunset" class="list-inline-item">Закат</li>
                                    </ul>
                                </li>
                                <li class="list-group-item">
                                    <ul class="list-inline">
                                        <li class="list-inline-item"><i class="bi bi-flag"></i></li>
                                        <li id="country" class="list-inline-item">Страна</li>
                                    </ul>
                                </li>
                                <li class="list-group-item">
                                    <ul class="list-inline">
                                        <li class="list-inline-item"><i class="bi bi-arrow-up-left"></i></li>
                                        <li id="lat" class="list-inline-item">Широта</li>
                                    </ul>
                                </li>
                                <li class="list-group-item">
                                    <ul class="list-inline">
                                        <li class="list-inline-item"><i class="bi bi-chevron-double-left"></i></li>
                                        <li id="lot" class="list-inline-item">Долгота</li>
                                    </ul>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div id="weatherFind" style="display: none;" class="card mt-3">
                <div class="card-body">
                    <h5>Поиск города</h5>
                    <div class="row g-3">
                        <div class="col-md-11">
                            <input id="cityName" class="form-control" placeholder="Название города">
                        </div>
                        <div class="col-md-1">
                            <button onclick="findCityWeather()" class="btn btn-primary">
                                Поиск
                            </button>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>


<script>
    const KEY = "3290eacf0e81438cab1132611233010"
    fetch(`https://api64.ipify.org?format=json`)
        .then(response => response.json())
        .then(data => {
            fetch(`https://ipapi.co/${data.ip}/json/`)
                .then(response => response.json())
                .then(data => {
                    document.getElementById("info").innerText = `Your city is ${data.city}`
                    city = data.city
                    getWeather(city)
                })
                .catch(error => console.error('Error:', error));
        })
        .catch(error => console.error('Error:', error));

    function getWeather(city) {
        setTimeout(() => {
            fetch(`https://api.weatherapi.com/v1/current.json?key=${KEY}&q=${city}&aqi=yes&lang=ru`)
                .then(response => response.json())
                .then(data => {
                    console.log(data)
                    document.getElementById("spinner").style.display = "none"
                    document.getElementById("card").style.display = "block"
                    document.getElementById("weatherFind").style.display = "block"

                    document.getElementById("temp").innerText = `${data.current.temp_c} °C`
                    document.getElementById("info").innerText = `Сейчас в городе ${city} ${data.current.condition.text.toLowerCase()}`

                    document.getElementById("time").innerText = `Время: ${data.location.localtime}`
                    document.getElementById("feels").innerText = `Ощущается как: ${data.current.feelslike_c} °C`
                    document.getElementById("humi").innerText = `Влажность: ${data.current.humidity}%`
                    document.getElementById("uv").innerText = `У/Ф излучение: ${data.current.uv}`
                    document.getElementById("visi").innerText = `Видимость: ${data.current.vis_km}`

                    document.getElementById("co").innerText = `CO: ${data.current.air_quality.co}`
                    document.getElementById("no2").innerText = `NO₂: ${data.current.air_quality.no2}`
                    document.getElementById("o3").innerText = `O₃: ${data.current.air_quality.o3}`
                    document.getElementById("pm25").innerText = `PM 2.5: ${data.current.air_quality.pm2_5}`
                    document.getElementById("pm10").innerText = `PM 10: ${data.current.air_quality.pm10}`

                    document.getElementById("country").innerText = `Страна: ${data.location.country}`
                    document.getElementById("lat").innerText = `Широта: ${data.location.lat}`
                    document.getElementById("lot").innerText = `Долгота: ${data.location.lon}`

                    fetch(`https://api.weatherapi.com/v1/astronomy.json?key=${KEY}&q=${city}&lang=ru`)
                        .then(response => response.json())
                        .then(ast => {
                            document.getElementById("sunrise").innerText = `Восход: ${ast.astronomy.astro.sunrise}`
                            document.getElementById("sunset").innerText = `Закат: ${ast.astronomy.astro.sunset}`
                        })
                        .catch(error => console.error('Error:', error));
                })
                .catch(error => console.error('Error:', error));
        }, 1500)
    }

    document.getElementById("cityName").addEventListener('keypress', function (event) {
        if (event.key === 'Enter') {
            findCityWeather()
        }
    })

    function findCityWeather() {
        var cityName = document.getElementById("cityName").value
        document.getElementById("spinner").style.display = "block"
        document.getElementById("card").style.display = "none"
        document.getElementById("weatherFind").style.display = "none"

        setTimeout(() => {
            fetch(`https://api.weatherapi.com/v1/current.json?key=${KEY}&q=${cityName}&aqi=yes&lang=ru`)
                .then(response => response.json())
                .then(data => {
                    console.log(data)
                    document.getElementById("spinner").style.display = "none"
                    document.getElementById("card").style.display = "block"
                    document.getElementById("weatherFind").style.display = "block"

                    document.getElementById("city")
                    document.getElementById("temp").innerText = `${data.current.temp_c} °C`
                    document.getElementById("info").innerText = `Сейчас в городе ${cityName} ${data.current.condition.text.toLowerCase()}`

                    document.getElementById("time").innerText = `Время: ${data.location.localtime}`
                    document.getElementById("feels").innerText = `Ощущается как: ${data.current.feelslike_c} °C`
                    document.getElementById("humi").innerText = `Влажность: ${data.current.humidity}%`
                    document.getElementById("uv").innerText = `У/Ф излучение: ${data.current.uv}`
                    document.getElementById("visi").innerText = `Видимость: ${data.current.vis_km}`

                    document.getElementById("co").innerText = `CO: ${data.current.air_quality.co}`
                    document.getElementById("no2").innerText = `NO₂: ${data.current.air_quality.no2}`
                    document.getElementById("o3").innerText = `O₃: ${data.current.air_quality.o3}`
                    document.getElementById("pm25").innerText = `PM 2.5: ${data.current.air_quality.pm2_5}`
                    document.getElementById("pm10").innerText = `PM 10: ${data.current.air_quality.pm10}`

                    document.getElementById("country").innerText = `Страна: ${data.location.country}`
                    document.getElementById("lat").innerText = `Широта: ${data.location.lat}`
                    document.getElementById("lot").innerText = `Долгота: ${data.location.lon}`

                    fetch(`https://api.weatherapi.com/v1/astronomy.json?key=${KEY}&q=${city}&lang=ru`)
                        .then(response => response.json())
                        .then(ast => {
                            document.getElementById("sunrise").innerText = `Восход: ${ast.astronomy.astro.sunrise}`
                            document.getElementById("sunset").innerText = `Закат: ${ast.astronomy.astro.sunset}`
                        })
                        .catch(error => console.error('Error:', error));
                })
                .catch(error => console.error('Error:', error));
        }, 1500)
    }
</script>

</body>
</html>